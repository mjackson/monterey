/*!
 * monterey.js - https://github.com/mjijackson/monterey.js
 * Copyright 2012 Michael Jackson
 */(function(){function n(e,t,r){typeof r=="function"&&n(r,"__monterey_name__",t),Object.defineProperty(e,t,{value:r,enumerable:!1,writable:!0,configurable:!0})}function r(e,t){for(var r in t)n(e,r,t[r])}function i(e,t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!0,get:n})}function s(e){return function t(){var n=t.caller;return e[n.__monterey_name__||n.name]}}var e=Array.prototype.slice,t=1;r(Object,{merge:function(t){var n=e.call(arguments,1),r;return n.forEach(function(e){for(r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}),t},copy:function(e){return Object.merge({},e)},guid:function(e){return e.hasOwnProperty("__monterey_guid__")||n(e,"__monterey_guid__",String(Date.now()+"_"+t++)),e.__monterey_guid__},events:function(e){return e.hasOwnProperty("__monterey_events__")||n(e,"__monterey_events__",{}),e.__monterey_events__},on:function(e,t,n){if(typeof n!="function")throw new Error("Event handler must be a function");var r=Object.events(e),i=r[t];i||(r[t]=i=[]),i.push(n),Object.trigger(e,"eventAdded",t,n)},off:function(e,t,n){var r=Object.events(e);if(!n){delete r[t];return}var i=r[t],s=Object.guid(n);if(!i||!s)return;for(var o=0;o<i.length;++o)i[o].__monterey_guid__===s&&Object.trigger(e,"eventRemoved",t,i.splice(o--,1));i.length===0&&delete r[t]},trigger:function(t,n){var r=Object.events(t),i=r[n];if(!i)return;var s={type:n,time:new Date,source:t},o=[s].concat(e.call(arguments,2));for(var u=0,a=i.length;u<a;++u)if(i[u].apply(t,o)===!1)break}}),r(Function.prototype,{inherit:function(e){if(typeof e!="function")throw new Error("Parent must be a function");r(this,e),this.prototype=Object.create(e.prototype),n(this.prototype,"constructor",this),i(this.prototype,"super",s(e.prototype))},extend:function(e){var t=this;typeof e=="function"&&(e=e(t.prototype));var n;return e&&e.hasOwnProperty("constructor")?n=e.constructor:n=function(){t.apply(this,arguments)},n.inherit(t),e&&r(n.prototype,e),n},isParentOf:function(e){return this.prototype===Object.getPrototypeOf(e.prototype)},isChildOf:function(e){return e.isParentOf(this)},isAncestorOf:function(e){return this.prototype.isPrototypeOf(e.prototype)},isDescendantOf:function(e){return e.isAncestorOf(this)}}),i(Function.prototype,"parent",function(){var e=Object.getPrototypeOf(this.prototype);return e&&e.constructor}),i(Function.prototype,"ancestors",function(){var e=[],t=this;do e.push(t);while(t=t.parent);return e})})();